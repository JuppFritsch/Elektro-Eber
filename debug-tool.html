<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîß Debug Tool - Elektro Eber</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .debug-container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 2rem;
            background: var(--card-bg);
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .debug-section {
            margin: 2rem 0;
            padding: 1.5rem;
            background: var(--bg-secondary);
            border-radius: 10px;
            border-left: 4px solid var(--primary);
        }
        
        .code-block {
            background: #1a1a1a;
            color: #00ff00;
            padding: 1rem;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 1rem 0;
        }
        
        .test-button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            cursor: pointer;
            margin: 0.5rem;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .test-button:hover {
            background: var(--secondary);
            transform: translateY(-1px);
        }
        
        .status-ok {
            color: #10b981;
            font-weight: bold;
        }
        
        .status-error {
            color: #ef4444;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="debug-container">
        <h1>üîß Debug Tool - Terminbuchung System</h1>
        <p>Hier k√∂nnen Sie testen was schief l√§uft und Probleme beheben.</p>
        
        <!-- Test 1: LocalStorage pr√ºfen -->
        <div class="debug-section">
            <h2>üìä Test 1: Gespeicherte Buchungen pr√ºfen</h2>
            <button onclick="checkLocalStorage()" class="test-button">LocalStorage pr√ºfen</button>
            <div id="localStorageResult" class="code-block" style="display: none;">
                <!-- Ergebnis wird hier angezeigt -->
            </div>
        </div>
        
        <!-- Test 2: Test-Buchung erstellen -->
        <div class="debug-section">
            <h2>üß™ Test 2: Test-Buchung erstellen</h2>
            <button onclick="createTestBooking()" class="test-button">Test-Buchung erstellen</button>
            <button onclick="clearAllBookings()" class="test-button" style="background: #ef4444;">Alle Buchungen l√∂schen</button>
            <div id="testBookingResult" class="code-block" style="display: none;">
                <!-- Ergebnis wird hier angezeigt -->
            </div>
        </div>
        
        <!-- Test 3: Admin Dashboard Link -->
        <div class="debug-section">
            <h2>üìã Test 3: Admin Dashboard pr√ºfen</h2>
            <p>√ñffnen Sie das Admin Dashboard in einem neuen Tab und pr√ºfen Sie ob Buchungen angezeigt werden:</p>
            <a href="admin-dashboard.html" target="_blank" class="test-button" style="text-decoration: none;">
                üìä Admin Dashboard √∂ffnen
            </a>
        </div>
        
        <!-- Test 4: Browser Kompatibilit√§t -->
        <div class="debug-section">
            <h2>üåê Test 4: Browser Kompatibilit√§t</h2>
            <button onclick="checkBrowserSupport()" class="test-button">Browser Features pr√ºfen</button>
            <div id="browserSupportResult" class="code-block" style="display: none;">
                <!-- Ergebnis wird hier angezeigt -->
            </div>
        </div>
        
        <!-- Test 5: Schritt-f√ºr-Schritt Debug -->
        <div class="debug-section">
            <h2>üîç Test 5: Live Debug - Buchungsvorgang testen</h2>
            <p>F√ºhren Sie eine komplette Test-Buchung durch:</p>
            <ol style="line-height: 1.8;">
                <li><a href="index.html" target="_blank">Website √∂ffnen</a></li>
                <li>Auf "Beratungstermin buchen" klicken</li>
                <li>Service ausw√§hlen (z.B. "Allgemeine Beratung")</li>
                <li>Datum und Zeit w√§hlen</li>
                <li>Testdaten eingeben:
                    <div class="code-block">
                        Vorname: Test<br>
                        Nachname: Kunde<br>
                        E-Mail: test@example.com<br>
                        Telefon: 0123 456789
                    </div>
                </li>
                <li>Auf "Termin verbindlich buchen" klicken</li>
                <li>Zur√ºck zu diesem Debug Tool und pr√ºfen:</li>
            </ol>
            <button onclick="checkAfterBooking()" class="test-button">Nach Buchung pr√ºfen</button>
        </div>
        
        <!-- Ergebnis-Anzeige -->
        <div class="debug-section">
            <h2>üìä Live-Status</h2>
            <div id="liveStatus">
                <p>Klicken Sie auf die Tests oben um den Status zu pr√ºfen...</p>
            </div>
        </div>
        
        <!-- Zur√ºck -->
        <div style="text-align: center; margin: 3rem 0;">
            <a href="index.html" class="test-button" style="text-decoration: none;">
                üè† Zur√ºck zur Website
            </a>
        </div>
    </div>

    <script>
        function checkLocalStorage() {
            const resultDiv = document.getElementById('localStorageResult');
            const bookings = localStorage.getItem('elektro-eber-bookings');
            
            resultDiv.style.display = 'block';
            
            if (!bookings) {
                resultDiv.innerHTML = `
                    <span class="status-error">‚ùå PROBLEM GEFUNDEN!</span><br>
                    Keine Buchungen in LocalStorage gefunden.<br>
                    <br>
                    M√∂gliche Ursachen:<br>
                    ‚Ä¢ Browser blockiert LocalStorage<br>
                    ‚Ä¢ Private Browsing Modus<br>
                    ‚Ä¢ Browser-Sicherheitseinstellungen<br>
                    <br>
                    L√ñSUNG: Erstellen Sie eine Test-Buchung unten.
                `;
            } else {
                const parsedBookings = JSON.parse(bookings);
                resultDiv.innerHTML = `
                    <span class="status-ok">‚úÖ LocalStorage funktioniert!</span><br>
                    Gefundene Buchungen: ${parsedBookings.length}<br>
                    <br>
                    Daten: ${JSON.stringify(parsedBookings, null, 2)}
                `;
            }
            
            updateLiveStatus();
        }
        
        function createTestBooking() {
            const testBooking = {
                bookingId: 'DEBUG-' + Date.now(),
                service: {
                    title: 'Debug Test Beratung',
                    duration: 30,
                    price: 'Kostenlos'
                },
                date: '2025-01-15',
                time: '14:00',
                customer: {
                    firstName: 'Debug',
                    lastName: 'Test',
                    email: 'debug@test.com',
                    phone: '0123 456789',
                    address: 'Teststra√üe 123',
                    message: 'Debug Test-Buchung'
                },
                status: 'Neu',
                timestamp: new Date().toISOString(),
                source: 'debug-tool'
            };
            
            // In LocalStorage speichern
            const existingBookings = JSON.parse(localStorage.getItem('elektro-eber-bookings') || '[]');
            existingBookings.push(testBooking);
            localStorage.setItem('elektro-eber-bookings', JSON.stringify(existingBookings));
            
            const resultDiv = document.getElementById('testBookingResult');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <span class="status-ok">‚úÖ Test-Buchung erstellt!</span><br>
                Buchungs-ID: ${testBooking.bookingId}<br>
                <br>
                Jetzt pr√ºfen Sie das Admin Dashboard:<br>
                1. √ñffnen Sie admin-dashboard.html<br>
                2. Die Test-Buchung sollte dort erscheinen<br>
                <br>
                Gespeichert: ${JSON.stringify(testBooking, null, 2)}
            `;
            
            updateLiveStatus();
        }
        
        function clearAllBookings() {
            localStorage.removeItem('elektro-eber-bookings');
            
            const resultDiv = document.getElementById('testBookingResult');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <span class="status-ok">‚úÖ Alle Buchungen gel√∂scht!</span><br>
                LocalStorage wurde geleert.<br>
                Sie k√∂nnen jetzt frisch testen.
            `;
            
            updateLiveStatus();
        }
        
        function checkBrowserSupport() {
            const resultDiv = document.getElementById('browserSupportResult');
            resultDiv.style.display = 'block';
            
            const support = {
                localStorage: typeof(Storage) !== "undefined",
                fetch: typeof(fetch) !== "undefined",
                json: typeof(JSON) !== "undefined",
                es6: typeof(Array.from) !== "undefined"
            };
            
            const allSupported = Object.values(support).every(s => s);
            
            resultDiv.innerHTML = `
                <span class="${allSupported ? 'status-ok' : 'status-error'}">
                    ${allSupported ? '‚úÖ' : '‚ùå'} Browser Kompatibilit√§t
                </span><br>
                <br>
                LocalStorage: ${support.localStorage ? '‚úÖ' : '‚ùå'}<br>
                Fetch API: ${support.fetch ? '‚úÖ' : '‚ùå'}<br>
                JSON Support: ${support.json ? '‚úÖ' : '‚ùå'}<br>
                ES6 Support: ${support.es6 ? '‚úÖ' : '‚ùå'}<br>
                <br>
                Browser: ${navigator.userAgent}<br>
                ${allSupported ? 'Ihr Browser unterst√ºtzt alle Features!' : 'Ihr Browser hat Kompatibilit√§tsprobleme!'}
            `;
        }
        
        function checkAfterBooking() {
            const bookings = JSON.parse(localStorage.getItem('elektro-eber-bookings') || '[]');
            const resultDiv = document.getElementById('testBookingResult');
            resultDiv.style.display = 'block';
            
            if (bookings.length === 0) {
                resultDiv.innerHTML = `
                    <span class="status-error">‚ùå PROBLEM!</span><br>
                    Keine Buchung wurde gespeichert.<br>
                    <br>
                    DEBUGGING SCHRITTE:<br>
                    1. √ñffnen Sie die Browser-Entwicklertools (F12)<br>
                    2. Gehen Sie zur Console<br>
                    3. F√ºhren Sie eine Buchung durch<br>
                    4. Schauen Sie nach JavaScript-Fehlern<br>
                    <br>
                    M√ñGLICHE URSACHEN:<br>
                    ‚Ä¢ JavaScript-Fehler im Code<br>
                    ‚Ä¢ LocalStorage blockiert<br>
                    ‚Ä¢ Form-Validation schl√§gt fehl
                `;
            } else {
                const latestBooking = bookings[bookings.length - 1];
                resultDiv.innerHTML = `
                    <span class="status-ok">‚úÖ BUCHUNG GEFUNDEN!</span><br>
                    Letzte Buchung: ${latestBooking.bookingId}<br>
                    Zeit: ${new Date(latestBooking.timestamp).toLocaleString('de-DE')}<br>
                    Kunde: ${latestBooking.customer.firstName} ${latestBooking.customer.lastName}<br>
                    <br>
                    Das System funktioniert korrekt!<br>
                    Pr√ºfen Sie jetzt das Admin Dashboard.
                `;
            }
            
            updateLiveStatus();
        }
        
        function updateLiveStatus() {
            const bookings = JSON.parse(localStorage.getItem('elektro-eber-bookings') || '[]');
            const statusDiv = document.getElementById('liveStatus');
            
            statusDiv.innerHTML = `
                <p><strong>üìä Aktueller Status:</strong></p>
                <p>Buchungen in LocalStorage: <span class="${bookings.length > 0 ? 'status-ok' : 'status-error'}">${bookings.length}</span></p>
                <p>Letzte Pr√ºfung: ${new Date().toLocaleTimeString('de-DE')}</p>
                ${bookings.length > 0 ? '<p class="status-ok">‚úÖ System funktioniert!</p>' : '<p class="status-error">‚ùå Keine Buchungen gefunden</p>'}
            `;
        }
        
        // Beim Laden automatisch pr√ºfen
        document.addEventListener('DOMContentLoaded', updateLiveStatus);
        
        // Automatische Updates alle 5 Sekunden
        setInterval(updateLiveStatus, 5000);
    </script>
</body>
</html>